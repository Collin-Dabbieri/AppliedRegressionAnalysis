---
title: "Laboratory 4"
author: "Collin Dabbieri"
date: "9/20/2019"
output: 
  html_document:
    toc: yes
    toc_float: yes
    keep_md: yes
---





# Task 1


```r
getwd()
```

```
## [1] "/home/collindabbieri/Documents/AppliedRegressionAnalysis/Labs/Lab4"
```


# Task 2


```r
library(readxl)

bubble=read_excel("/home/collindabbieri/Documents/AppliedRegressionAnalysis/Dataxls/Excel/BUBBLE2.xls")

head(bubble)
```

```
## # A tibble: 6 x 5
##   Label  MassFlux HeatFlux Diameter Density
##   <chr>     <dbl>    <dbl>    <dbl>   <dbl>
## 1 P4-145      406    0.15      0.64  13103.
## 2 P4-148      406    0.290     1.02  29117.
## 3 P4-149      406    0.37      1.15 123021.
## 4 P4-150      406    0.62      1.26 165969.
## 5 P4-151      406    0.86      0.91 254777.
## 6 P4-152      406    1         0.68 347953.
```


# Task 3

## Describe the data

The industry cooling application called subcooled flow boiling is susceptible to small bubbles near the heated surface. In a series of experiments, two important bubble behaviors, diameter and density, were measured. The mass flux and heat flux were varied for each experiment.

## create $(X'X)^{-1}$


```r
X=matrix(nrow=length(bubble$MassFlux),ncol=3)
X[,1]=1
X[,2]=bubble$MassFlux
X[,3]=bubble$HeatFlux

C=solve(t(X)%*%X)

print(C)
```

```
##               [,1]          [,2]       [,3]
## [1,]  0.5670263400 -4.111839e-04 -0.3243712
## [2,] -0.0004111839  5.068002e-07  0.0000000
## [3,] -0.3243712227 -3.587361e-19  0.5915585
```

## Using Theorem 11.1 and assuming $\sigma^2=100$ find $\sigma^2_{\hat{\beta}_i}$

Theorem 11.1- The sampling distribution of $\hat{\beta}_i(i=0,1,2,...,k)$ is normal with $E(\hat{\beta}_i)=\beta_i$, $V(\hat{\beta}_i)=c_{ii}\sigma^2$, $\sigma_{\hat{\beta}_i}=\sigma\sqrt{c_{ii}}$

We know that $\sigma^2=100$, all we need to calculate is $c_{ii}$, and then $\sigma^2_{\hat{\beta}_i}=\sigma^2c_{ii}$


```r
sigma2betahat=matrix(,nrow=3,ncol=1)
for(i in 1:3){
  val=100*C[i,i]
  sigma2betahat[i,1]=val
}
print(sigma2betahat)
```

```
##              [,1]
## [1,] 5.670263e+01
## [2,] 5.068002e-05
## [3,] 5.915585e+01
```

## Using the same theorem, find SSE

$SSE=Y'Y-\hat{\beta}'X'Y$

For this problem, y is the bubble diameter


```r
Y=matrix(data=bubble$Diameter,nrow=length(bubble$Diameter),ncol=1)
```


We need to find $\hat{\beta}$


```r
fit=lm(Y~bubble$MassFlux+bubble$HeatFlux)
summary(fit)
```

```
## 
## Call:
## lm(formula = Y ~ bubble$MassFlux + bubble$HeatFlux)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34129 -0.23205  0.04017  0.15505  0.32121 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      1.0884141  0.1837825   5.922  2.8e-05 ***
## bubble$MassFlux -0.0002343  0.0001737  -1.348    0.198    
## bubble$HeatFlux -0.0800181  0.1877160  -0.426    0.676    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2441 on 15 degrees of freedom
## Multiple R-squared:  0.1177,	Adjusted R-squared:  7.021e-06 
## F-statistic:     1 on 2 and 15 DF,  p-value: 0.3911
```

```r
print(fit$coefficients)
```

```
##     (Intercept) bubble$MassFlux bubble$HeatFlux 
##    1.0884141318   -0.0002342971   -0.0800181411
```



```r
betahat=matrix(data=c(1.0884141,-0.0002343,-0.0800181),nrow=3,ncol=1)

SSE=t(Y)%*%Y-t(betahat)%*%t(X)%*%Y
SSE
```

```
##           [,1]
## [1,] 0.8935381
```


# Task 4

## Using the model in 11.6 part b) (Y is bubble density) and Theorem 11.2, find 95% CIs for all three betas

Theorem 11.2- $\chi^2=\frac{SSE}{\sigma^2}$ has a chi-square distribution with $\nu=n-(k+1)$ degrees of freedom


a $100(1-\alpha)$% CI for $\beta$ comes from

$$ a'\hat{\beta} \pm t_{\alpha/2}s\sqrt{a'(X'X)^{-1}a} $$
where $a'\hat{\beta}$ gives any linear combination of $\hat{\beta}$


now we can find our CIs


```r
Y=matrix(data=bubble$Density,nrow=length(bubble$Density),ncol=1)
fit2=lm(Y~bubble$MassFlux+bubble$HeatFlux)
coef=fit2$coefficients
print(coef)
```

```
##     (Intercept) bubble$MassFlux bubble$HeatFlux 
##     -1030.03261       -57.89939    332037.08606
```

```r
betahat=matrix(data=c(coef[1],coef[2],coef[3]),nrow=3,ncol=1)
n=length(bubble$MassFlux)
k=3
df=n-(k+1)
SSE=t(Y)%*%Y-t(betahat)%*%t(X)%*%Y
s=sqrt(SSE/(n-k))
pm=c(-1,1)
alpha=0.05

CIs=matrix(,nrow=3,ncol=2)

for(i in 1:3){
  a=matrix(data=c(0,0,0),nrow=3,ncol=1)
  a[i,1]=1
  
  val=t(a)%*%betahat+pm*qt(1-alpha/2,df)*s*sqrt(t(a)%*%solve(t(X)%*%X)%*%a)
  CIs[i,1]=val[1]
  CIs[i,2]=val[2]
}
```

```
## Warning in pm * qt(1 - alpha/2, df) * s: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% solve(t(X) %*% X) %*% : Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in t(a) %*% betahat + pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% : Recycling array of length 1 in array-vector arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% solve(t(X) %*% X) %*% : Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in t(a) %*% betahat + pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% : Recycling array of length 1 in array-vector arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% solve(t(X) %*% X) %*% : Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in t(a) %*% betahat + pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% : Recycling array of length 1 in array-vector arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```r
rownames(CIs)=c("beta0","beta1","beta2")
print("95% Confidence interval for the betas is")
```

```
## [1] "95% Confidence interval for the betas is"
```

```r
CIs
```

```
##              [,1]         [,2]
## beta0 -46579.2144  44519.14922
## beta1   -100.9617    -14.83708
## beta2 285513.0055 378561.16659
```

## What do you conclude for the testing of the $\beta_i$s, i.e $H_0:\beta_i=0$

We can't reject the NULL, that any of the $\beta$s are equal to zero, as implausible at the 95% confidence level. Our 95% confidence interval for $\beta_0$ includes 0. However, each of the dependent variables seem to be important at the 95% confidence level.

## Create the appropriate summary information from R for the above test


```r
summary(fit2)
```

```
## 
## Call:
## lm(formula = Y ~ bubble$MassFlux + bubble$HeatFlux)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -42636 -19706  -9202  26264  40453 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -1030.03   21237.16  -0.049   0.9620    
## bubble$MassFlux    -57.90      20.08  -2.884   0.0114 *  
## bubble$HeatFlux 332037.09   21691.71  15.307 1.46e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 28200 on 15 degrees of freedom
## Multiple R-squared:  0.9418,	Adjusted R-squared:  0.934 
## F-statistic: 121.3 on 2 and 15 DF,  p-value: 5.474e-10
```


# Task 5


## Make a 3D plot for the data with Y=diameter



```r
library(rgl)
lim <- function(x){c(-max(abs(x)), max(abs(x))) * 1.1}


z=bubble$Diameter
x=bubble$MassFlux
y=bubble$HeatFlux

x1=(x-min(x))/(max(x)-min(x))
y1=(y-min(y))/(max(y)-min(y))
z1=(z-min(z))/(max(z)-min(z))
fit=lm(z1~x1+y1)

plotids <- plot3d(x1,y1,z1,col="blue")
rgl.lines(lim(x1), c(0, 0), c(0, 0), color = "black")
rgl.lines(c(0, 0), lim(y1), c(0, 0), color = "red")
rgl.lines(c(0, 0), c(0, 0), lim(z1), color = "green")
coeffs=coef(fit)
print(coeffs)
```

```
## (Intercept)          x1          y1 
##  0.66420093 -0.22893370 -0.08194629
```

```r
a=coeffs["x1"]
b=coeffs["y1"]
c=-1
d=coeffs["(Intercept)"]
planes3d(a,b,c,d,alpha=0.5,color="purple")
rglwidget()
```

<!--html_preserve--><div id="rgl84746" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl84746">{"x":{"material":{"color":"#00FF00","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"7":{"id":7,"type":"points","material":{"lit":false,"fog":false},"vertices":[[0,0,0.25301206111908],[0,0.164705887436867,0.7108433842659],[0,0.258823543787003,0.867469906806946],[0,0.552941203117371,1],[0,0.835294127464294,0.578313231468201],[0,1,0.301204830408096],[0.499383479356766,0,0.180722892284393],[0.499383479356766,0.164705887436867,0.662650585174561],[0.499383479356766,0.258823543787003,0.7108433842659],[0.499383479356766,0.552941203117371,0.891566276550293],[0.499383479356766,0.835294127464294,0.518072307109833],[0.499383479356766,1,0.192771077156067],[1,0,0.0722891539335251],[1,0.164705887436867,0.445783138275146],[1,0.258823543787003,0.602409660816193],[1,0.552941203117371,0.759036123752594],[1,0.835294127464294,0.45783132314682],[1,1,0]],"colors":[[0,0,1,1]],"centers":[[0,0,0.25301206111908],[0,0.164705887436867,0.7108433842659],[0,0.258823543787003,0.867469906806946],[0,0.552941203117371,1],[0,0.835294127464294,0.578313231468201],[0,1,0.301204830408096],[0.499383479356766,0,0.180722892284393],[0.499383479356766,0.164705887436867,0.662650585174561],[0.499383479356766,0.258823543787003,0.7108433842659],[0.499383479356766,0.552941203117371,0.891566276550293],[0.499383479356766,0.835294127464294,0.518072307109833],[0.499383479356766,1,0.192771077156067],[1,0,0.0722891539335251],[1,0.164705887436867,0.445783138275146],[1,0.258823543787003,0.602409660816193],[1,0.552941203117371,0.759036123752594],[1,0.835294127464294,0.45783132314682],[1,1,0]],"ignoreExtent":false,"flags":4096},"9":{"id":9,"type":"text","material":{"lit":false,"fog":false},"vertices":[[0.5,-0.16949999332428,-0.16949999332428]],"colors":[[0,0,0,1]],"texts":[["x1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0.5,-0.16949999332428,-0.16949999332428]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"10":{"id":10,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-0.16949999332428,0.5,-0.16949999332428]],"colors":[[0,0,0,1]],"texts":[["y1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,0.5,-0.16949999332428]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"11":{"id":11,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-0.16949999332428,-0.16949999332428,0.5]],"colors":[[0,0,0,1]],"texts":[["z1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,-0.16949999332428,0.5]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"12":{"id":12,"type":"lines","material":{"lit":false},"vertices":[[-1.10000002384186,0,0],[1.10000002384186,0,0]],"colors":[[0,0,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"13":{"id":13,"type":"lines","material":{"lit":false},"vertices":[[0,-1.10000002384186,0],[0,1.10000002384186,0]],"colors":[[1,0,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"14":{"id":14,"type":"lines","material":{"lit":false},"vertices":[[0,0,-1.10000002384186],[0,0,1.10000002384186]],"colors":[[0,1,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"15":{"id":15,"type":"planes","material":{"alpha":0.498039215803146,"isTransparent":true},"vertices":[[-1.10000002384186,-1.10000002384186,1.00616896152496],[-1.10000002384186,1.10000002384186,0.825887143611908],[1.10000002384186,1.10000002384186,0.322232961654663]],"normals":[[-0.228933706879616,-0.0819462910294533,-1]],"colors":[[0.627451002597809,0.125490203499794,0.941176474094391,0.498039215803146]],"offsets":[[0.664200961589813]],"centers":[[-0.366666674613953,0.366666674613953,0.718096375465393],[0.366666674613953,-0.366666674613953,0.610305547714233],["NaN","NaN","NaN"],["NaN","NaN","NaN"]],"ignoreExtent":true,"flags":35},"5":{"id":5,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"4":{"id":4,"type":"background","material":{},"colors":[[0.298039227724075,0.298039227724075,0.298039227724075,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"6":{"id":6,"type":"background","material":{"lit":false,"back":"lines","fog":false},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"8":{"id":8,"type":"bboxdeco","material":{"color":"#000000","front":"lines","back":"lines","fog":false},"vertices":[[-1,"NA","NA"],[-0.5,"NA","NA"],[0,"NA","NA"],[0.5,"NA","NA"],[1,"NA","NA"],["NA",-1,"NA"],["NA",-0.5,"NA"],["NA",0,"NA"],["NA",0.5,"NA"],["NA",1,"NA"],["NA","NA",-1],["NA","NA",-0.5],["NA","NA",0],["NA","NA",0.5],["NA","NA",1]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[23,24,25,26,27,28,29]},"1":{"id":1,"type":"subscene","par3d":{"antialias":0,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,9.32436943054199],"modelMatrix":[[1,0,0,0],[0,0.342020153999329,0.939692616462708,0],[0,-0.939692616462708,0.342020153999329,-9.32436943054199],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370325088501,-33.6132736206055],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-1.10000002384186,1.10000002384186,-1.10000002384186,1.10000002384186,-1.10000002384186,1.10000002384186],"windowRect":[48,147,304,403],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/home/collindabbieri/R/x86_64-redhat-linux-gnu-library/3.5/rgl/fonts/FreeSans.ttf","maxClipPlanes":8,"glVersion":3,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,8,7,9,10,11,12,13,14,15,5,23,24,25,26,27,28,29],"subscenes":[],"flags":6771},"23":{"id":23,"type":"lines","material":{"lit":false},"vertices":[[-1,-1.13300001621246,-1.13300001621246],[1,-1.13300001621246,-1.13300001621246],[-1,-1.13300001621246,-1.13300001621246],[-1,-1.18965005874634,-1.18965005874634],[-0.5,-1.13300001621246,-1.13300001621246],[-0.5,-1.18965005874634,-1.18965005874634],[0,-1.13300001621246,-1.13300001621246],[0,-1.18965005874634,-1.18965005874634],[0.5,-1.13300001621246,-1.13300001621246],[0.5,-1.18965005874634,-1.18965005874634],[1,-1.13300001621246,-1.13300001621246],[1,-1.18965005874634,-1.18965005874634]],"colors":[[0,0,0,1]],"centers":[[0,-1.13300001621246,-1.13300001621246],[-1,-1.16132497787476,-1.16132497787476],[-0.5,-1.16132497787476,-1.16132497787476],[0,-1.16132497787476,-1.16132497787476],[0.5,-1.16132497787476,-1.16132497787476],[1,-1.16132497787476,-1.16132497787476]],"ignoreExtent":true,"origId":8,"flags":64},"24":{"id":24,"type":"text","material":{"lit":false},"vertices":[[-1,-1.3029500246048,-1.3029500246048],[-0.5,-1.3029500246048,-1.3029500246048],[0,-1.3029500246048,-1.3029500246048],[0.5,-1.3029500246048,-1.3029500246048],[1,-1.3029500246048,-1.3029500246048]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1,-1.3029500246048,-1.3029500246048],[-0.5,-1.3029500246048,-1.3029500246048],[0,-1.3029500246048,-1.3029500246048],[0.5,-1.3029500246048,-1.3029500246048],[1,-1.3029500246048,-1.3029500246048]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":2064},"25":{"id":25,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1,-1.13300001621246],[-1.13300001621246,1,-1.13300001621246],[-1.13300001621246,-1,-1.13300001621246],[-1.18965005874634,-1,-1.18965005874634],[-1.13300001621246,-0.5,-1.13300001621246],[-1.18965005874634,-0.5,-1.18965005874634],[-1.13300001621246,0,-1.13300001621246],[-1.18965005874634,0,-1.18965005874634],[-1.13300001621246,0.5,-1.13300001621246],[-1.18965005874634,0.5,-1.18965005874634],[-1.13300001621246,1,-1.13300001621246],[-1.18965005874634,1,-1.18965005874634]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,0,-1.13300001621246],[-1.16132497787476,-1,-1.16132497787476],[-1.16132497787476,-0.5,-1.16132497787476],[-1.16132497787476,0,-1.16132497787476],[-1.16132497787476,0.5,-1.16132497787476],[-1.16132497787476,1,-1.16132497787476]],"ignoreExtent":true,"origId":8,"flags":64},"26":{"id":26,"type":"text","material":{"lit":false},"vertices":[[-1.3029500246048,-1,-1.3029500246048],[-1.3029500246048,-0.5,-1.3029500246048],[-1.3029500246048,0,-1.3029500246048],[-1.3029500246048,0.5,-1.3029500246048],[-1.3029500246048,1,-1.3029500246048]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.3029500246048,-1,-1.3029500246048],[-1.3029500246048,-0.5,-1.3029500246048],[-1.3029500246048,0,-1.3029500246048],[-1.3029500246048,0.5,-1.3029500246048],[-1.3029500246048,1,-1.3029500246048]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":2064},"27":{"id":27,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1.13300001621246,-1],[-1.13300001621246,-1.13300001621246,1],[-1.13300001621246,-1.13300001621246,-1],[-1.18965005874634,-1.18965005874634,-1],[-1.13300001621246,-1.13300001621246,-0.5],[-1.18965005874634,-1.18965005874634,-0.5],[-1.13300001621246,-1.13300001621246,0],[-1.18965005874634,-1.18965005874634,0],[-1.13300001621246,-1.13300001621246,0.5],[-1.18965005874634,-1.18965005874634,0.5],[-1.13300001621246,-1.13300001621246,1],[-1.18965005874634,-1.18965005874634,1]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,-1.13300001621246,0],[-1.16132497787476,-1.16132497787476,-1],[-1.16132497787476,-1.16132497787476,-0.5],[-1.16132497787476,-1.16132497787476,0],[-1.16132497787476,-1.16132497787476,0.5],[-1.16132497787476,-1.16132497787476,1]],"ignoreExtent":true,"origId":8,"flags":64},"28":{"id":28,"type":"text","material":{"lit":false},"vertices":[[-1.3029500246048,-1.3029500246048,-1],[-1.3029500246048,-1.3029500246048,-0.5],[-1.3029500246048,-1.3029500246048,0],[-1.3029500246048,-1.3029500246048,0.5],[-1.3029500246048,-1.3029500246048,1]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.3029500246048,-1.3029500246048,-1],[-1.3029500246048,-1.3029500246048,-0.5],[-1.3029500246048,-1.3029500246048,0],[-1.3029500246048,-1.3029500246048,0.5],[-1.3029500246048,-1.3029500246048,1]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":2064},"29":{"id":29,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[-1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[-1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,0,-1.13300001621246],[-1.13300001621246,0,1.13300001621246],[-1.13300001621246,-1.13300001621246,0],[-1.13300001621246,1.13300001621246,0],[0,-1.13300001621246,-1.13300001621246],[0,-1.13300001621246,1.13300001621246],[0,1.13300001621246,-1.13300001621246],[0,1.13300001621246,1.13300001621246],[1.13300001621246,0,-1.13300001621246],[1.13300001621246,0,1.13300001621246],[1.13300001621246,-1.13300001621246,0],[1.13300001621246,1.13300001621246,0]],"ignoreExtent":true,"origId":8,"flags":64},"36":{"id":36,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":36,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143208,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143208,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1],[0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.58793780120968,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.58793780120968,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517866,-0.38268343236509,-0.375330277517866,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0.137949689641472,0.270598050073098,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073098,0.137949689641472,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271]],"material":[],"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1]],"meshColor":"vertices"},"context":{"shiny":false,"rmarkdown":"html_document"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->


## Do the same with Y=density


```r
z=bubble$Density
x=bubble$MassFlux
y=bubble$HeatFlux

x1=(x-min(x))/(max(x)-min(x))
y1=(y-min(y))/(max(y)-min(y))
z1=(z-min(z))/(max(z)-min(z))
fit=lm(z1~x1+y1)
coeffs=coef(fit)
print(coeffs)
```

```
## (Intercept)          x1          y1 
##  0.05883744 -0.13695618  0.82317523
```

```r
a=coeffs["x1"]
b=coeffs["y1"]
c=-1
d=coeffs["(Intercept)"]


plotids <- plot3d(x1,y1,z1,col="blue")
rgl.lines(lim(x1), c(0, 0), c(0, 0), color = "black")
rgl.lines(c(0, 0), lim(y1), c(0, 0), color = "red")
rgl.lines(c(0, 0), c(0, 0), lim(z1), color = "green")
planes3d(a,b,c,d,alpha=0.5,color="purple")
rglwidget()
```

<!--html_preserve--><div id="rgl45026" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl45026">{"x":{"material":{"color":"#00FF00","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"37":{"id":37,"type":"points","material":{"lit":false,"fog":false},"vertices":[[0,0,0.0233545657247305],[0,0.164705887436867,0.0700636953115463],[0,0.258823543787003,0.34394896030426],[0,0.552941203117371,0.469214528799057],[0,0.835294127464294,0.728237867355347],[0,1,1],[0.499383479356766,0,0.0063694161362946],[0.499383479356766,0.164705887436867,0.050955418497324],[0.499383479356766,0.258823543787003,0.295116662979126],[0.499383479356766,0.552941203117371,0.409766435623169],[0.499383479356766,0.835294127464294,0.639065742492676],[0.499383479356766,1,0.92144364118576],[1,0,0],[1,0.164705887436867,0.0403397157788277],[1,0.258823543787003,0.250530779361725],[1,0.552941203117371,0.312101870775223],[1,0.835294127464294,0.54777055978775],[1,1,0.662420332431793]],"colors":[[0,0,1,1]],"centers":[[0,0,0.0233545657247305],[0,0.164705887436867,0.0700636953115463],[0,0.258823543787003,0.34394896030426],[0,0.552941203117371,0.469214528799057],[0,0.835294127464294,0.728237867355347],[0,1,1],[0.499383479356766,0,0.0063694161362946],[0.499383479356766,0.164705887436867,0.050955418497324],[0.499383479356766,0.258823543787003,0.295116662979126],[0.499383479356766,0.552941203117371,0.409766435623169],[0.499383479356766,0.835294127464294,0.639065742492676],[0.499383479356766,1,0.92144364118576],[1,0,0],[1,0.164705887436867,0.0403397157788277],[1,0.258823543787003,0.250530779361725],[1,0.552941203117371,0.312101870775223],[1,0.835294127464294,0.54777055978775],[1,1,0.662420332431793]],"ignoreExtent":false,"flags":4096},"39":{"id":39,"type":"text","material":{"lit":false,"fog":false},"vertices":[[0.5,-0.16949999332428,-0.16949999332428]],"colors":[[0,0,0,1]],"texts":[["x1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0.5,-0.16949999332428,-0.16949999332428]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"40":{"id":40,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-0.16949999332428,0.5,-0.16949999332428]],"colors":[[0,0,0,1]],"texts":[["y1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,0.5,-0.16949999332428]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"41":{"id":41,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-0.16949999332428,-0.16949999332428,0.5]],"colors":[[0,0,0,1]],"texts":[["z1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,-0.16949999332428,0.5]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"42":{"id":42,"type":"lines","material":{"lit":false},"vertices":[[-1.10000002384186,0,0],[1.10000002384186,0,0]],"colors":[[0,0,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"43":{"id":43,"type":"lines","material":{"lit":false},"vertices":[[0,-1.10000002384186,0],[0,1.10000002384186,0]],"colors":[[1,0,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"44":{"id":44,"type":"lines","material":{"lit":false},"vertices":[[0,0,-1.10000002384186],[0,0,1.10000002384186]],"colors":[[0,1,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"45":{"id":45,"type":"planes","material":{"alpha":0.498039215803146,"isTransparent":true},"vertices":[[-1.10000002384186,-1.10000002384186,-0.696003556251526],[1.10000002384186,1.10000002384186,0.813678443431854],[1.10000002384186,-1.10000002384186,-0.997307121753693]],"normals":[[-0.136956170201302,0.823175251483917,-1]],"colors":[[0.627451002597809,0.125490203499794,0.941176474094391,0.498039215803146]],"offsets":[[0.0588374398648739]],"centers":[[0.366666674613953,-0.366666674613953,-0.293210744857788],[-0.330202460289001,0.366666674613953,0.40589165687561],[-1.06353580951691,0.360599935054779,0.50133216381073],["NaN","NaN","NaN"]],"ignoreExtent":true,"flags":35},"5":{"id":5,"reuse":"rgl84746"},"6":{"id":6,"reuse":"rgl84746"},"38":{"id":38,"type":"bboxdeco","material":{"color":"#000000","front":"lines","back":"lines","fog":false},"vertices":[[-1,"NA","NA"],[-0.5,"NA","NA"],[0,"NA","NA"],[0.5,"NA","NA"],[1,"NA","NA"],["NA",-1,"NA"],["NA",-0.5,"NA"],["NA",0,"NA"],["NA",0.5,"NA"],["NA",1,"NA"],["NA","NA",-1],["NA","NA",-0.5],["NA","NA",0],["NA","NA",0.5],["NA","NA",1]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[53,54,55,56,57,58,59]},"1":{"id":1,"type":"subscene","par3d":{"antialias":0,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,9.32436943054199],"modelMatrix":[[1,0,0,0],[0,0.342020153999329,0.939692616462708,0],[0,-0.939692616462708,0.342020153999329,-9.32436943054199],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370325088501,-33.6132736206055],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-1.10000002384186,1.10000002384186,-1.10000002384186,1.10000002384186,-1.10000002384186,1.10000002384186],"windowRect":[48,147,304,403],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/home/collindabbieri/R/x86_64-redhat-linux-gnu-library/3.5/rgl/fonts/FreeSans.ttf","maxClipPlanes":8,"glVersion":3,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,38,37,39,40,41,42,43,44,45,5,53,54,55,56,57,58,59],"subscenes":[],"flags":6771},"53":{"id":53,"type":"lines","material":{"lit":false},"vertices":[[-1,-1.13300001621246,-1.13300001621246],[1,-1.13300001621246,-1.13300001621246],[-1,-1.13300001621246,-1.13300001621246],[-1,-1.18965005874634,-1.18965005874634],[-0.5,-1.13300001621246,-1.13300001621246],[-0.5,-1.18965005874634,-1.18965005874634],[0,-1.13300001621246,-1.13300001621246],[0,-1.18965005874634,-1.18965005874634],[0.5,-1.13300001621246,-1.13300001621246],[0.5,-1.18965005874634,-1.18965005874634],[1,-1.13300001621246,-1.13300001621246],[1,-1.18965005874634,-1.18965005874634]],"colors":[[0,0,0,1]],"centers":[[0,-1.13300001621246,-1.13300001621246],[-1,-1.16132497787476,-1.16132497787476],[-0.5,-1.16132497787476,-1.16132497787476],[0,-1.16132497787476,-1.16132497787476],[0.5,-1.16132497787476,-1.16132497787476],[1,-1.16132497787476,-1.16132497787476]],"ignoreExtent":true,"origId":38,"flags":64},"54":{"id":54,"type":"text","material":{"lit":false},"vertices":[[-1,-1.3029500246048,-1.3029500246048],[-0.5,-1.3029500246048,-1.3029500246048],[0,-1.3029500246048,-1.3029500246048],[0.5,-1.3029500246048,-1.3029500246048],[1,-1.3029500246048,-1.3029500246048]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1,-1.3029500246048,-1.3029500246048],[-0.5,-1.3029500246048,-1.3029500246048],[0,-1.3029500246048,-1.3029500246048],[0.5,-1.3029500246048,-1.3029500246048],[1,-1.3029500246048,-1.3029500246048]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":38,"flags":2064},"55":{"id":55,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1,-1.13300001621246],[-1.13300001621246,1,-1.13300001621246],[-1.13300001621246,-1,-1.13300001621246],[-1.18965005874634,-1,-1.18965005874634],[-1.13300001621246,-0.5,-1.13300001621246],[-1.18965005874634,-0.5,-1.18965005874634],[-1.13300001621246,0,-1.13300001621246],[-1.18965005874634,0,-1.18965005874634],[-1.13300001621246,0.5,-1.13300001621246],[-1.18965005874634,0.5,-1.18965005874634],[-1.13300001621246,1,-1.13300001621246],[-1.18965005874634,1,-1.18965005874634]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,0,-1.13300001621246],[-1.16132497787476,-1,-1.16132497787476],[-1.16132497787476,-0.5,-1.16132497787476],[-1.16132497787476,0,-1.16132497787476],[-1.16132497787476,0.5,-1.16132497787476],[-1.16132497787476,1,-1.16132497787476]],"ignoreExtent":true,"origId":38,"flags":64},"56":{"id":56,"type":"text","material":{"lit":false},"vertices":[[-1.3029500246048,-1,-1.3029500246048],[-1.3029500246048,-0.5,-1.3029500246048],[-1.3029500246048,0,-1.3029500246048],[-1.3029500246048,0.5,-1.3029500246048],[-1.3029500246048,1,-1.3029500246048]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.3029500246048,-1,-1.3029500246048],[-1.3029500246048,-0.5,-1.3029500246048],[-1.3029500246048,0,-1.3029500246048],[-1.3029500246048,0.5,-1.3029500246048],[-1.3029500246048,1,-1.3029500246048]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":38,"flags":2064},"57":{"id":57,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1.13300001621246,-1],[-1.13300001621246,-1.13300001621246,1],[-1.13300001621246,-1.13300001621246,-1],[-1.18965005874634,-1.18965005874634,-1],[-1.13300001621246,-1.13300001621246,-0.5],[-1.18965005874634,-1.18965005874634,-0.5],[-1.13300001621246,-1.13300001621246,0],[-1.18965005874634,-1.18965005874634,0],[-1.13300001621246,-1.13300001621246,0.5],[-1.18965005874634,-1.18965005874634,0.5],[-1.13300001621246,-1.13300001621246,1],[-1.18965005874634,-1.18965005874634,1]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,-1.13300001621246,0],[-1.16132497787476,-1.16132497787476,-1],[-1.16132497787476,-1.16132497787476,-0.5],[-1.16132497787476,-1.16132497787476,0],[-1.16132497787476,-1.16132497787476,0.5],[-1.16132497787476,-1.16132497787476,1]],"ignoreExtent":true,"origId":38,"flags":64},"58":{"id":58,"type":"text","material":{"lit":false},"vertices":[[-1.3029500246048,-1.3029500246048,-1],[-1.3029500246048,-1.3029500246048,-0.5],[-1.3029500246048,-1.3029500246048,0],[-1.3029500246048,-1.3029500246048,0.5],[-1.3029500246048,-1.3029500246048,1]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.3029500246048,-1.3029500246048,-1],[-1.3029500246048,-1.3029500246048,-0.5],[-1.3029500246048,-1.3029500246048,0],[-1.3029500246048,-1.3029500246048,0.5],[-1.3029500246048,-1.3029500246048,1]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":38,"flags":2064},"59":{"id":59,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[-1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[-1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,0,-1.13300001621246],[-1.13300001621246,0,1.13300001621246],[-1.13300001621246,-1.13300001621246,0],[-1.13300001621246,1.13300001621246,0],[0,-1.13300001621246,-1.13300001621246],[0,-1.13300001621246,1.13300001621246],[0,1.13300001621246,-1.13300001621246],[0,1.13300001621246,1.13300001621246],[1.13300001621246,0,-1.13300001621246],[1.13300001621246,0,1.13300001621246],[1.13300001621246,-1.13300001621246,0],[1.13300001621246,1.13300001621246,0]],"ignoreExtent":true,"origId":38,"flags":64},"66":{"id":66,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":66,"sphereVerts":{"reuse":"rgl84746"},"context":{"shiny":false,"rmarkdown":"html_document"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->


# Task 6


```r
library(rgl)
myreg=function(Y,X,alpha){
  #X has shape nx3
  
  k=ncol(X)-1
  n=nrow(X)

  fit2=lm(Y~X[,2]+X[,3])
  coef=fit2$coefficients
  betahat=matrix(data=c(coef[1],coef[2],coef[3]),nrow=3,ncol=1)
  df=n-(k+1)
  SSE=t(Y)%*%Y-t(betahat)%*%t(X)%*%Y
  s=sqrt(SSE/n-k)
  s2=SSE/(n-k)
  pm=c(-1,1)
  alpha=0.05

  CIs=matrix(,nrow=3,ncol=2)

  for(i in 1:3){
    a=matrix(data=c(0,0,0),nrow=3,ncol=1)
    a[i,1]=1
  
    val=t(a)%*%betahat+pm*qt(1-alpha/2,df)*s*sqrt(t(a)%*%solve(t(X)%*%X)%*%a)
    CIs[i,1]=val[1]
    CIs[i,2]=val[2]
  }
  rownames(CIs)=c("beta0","beta1","beta2")
  
  #rgl plot with points and regression plane
  lim <- function(x){c(-max(abs(x)), max(abs(x))) * 1.1}
  x=X[,2]
  y=X[,3]
  z=Y
  
  x1=(x-min(x))/(max(x)-min(x))
  y1=(y-min(y))/(max(y)-min(y))
  z1=(z-min(z))/(max(z)-min(z))
  fit=lm(z1~x1+y1)
  coeffs=coef(fit)
  a=coeffs["x1"]
  b=coeffs["y1"]
  c=-1
  d=coeffs["(Intercept)"]

  plotids <- plot3d(x1,y1,z1,col="blue")
  rgl.lines(lim(x1), c(0, 0), c(0, 0), color = "black")
  rgl.lines(c(0, 0), lim(y1), c(0, 0), color = "red")
  rgl.lines(c(0, 0), c(0, 0), lim(z1), color = "green")
  planes3d(a,b,c,d,alpha=0.5,color="purple")
  #rglwidget()
  
  return(list(CIs=CIs,betahat=betahat,SSE=SSE,s2=s2))
}

Y=matrix(data=bubble$Density,nrow=length(bubble$Density),ncol=1)
myreg(Y,X,0.05)
```

```
## Warning in pm * qt(1 - alpha/2, df) * s: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% solve(t(X) %*% X) %*% : Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in t(a) %*% betahat + pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% : Recycling array of length 1 in array-vector arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% solve(t(X) %*% X) %*% : Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in t(a) %*% betahat + pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% : Recycling array of length 1 in array-vector arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% solve(t(X) %*% X) %*% : Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## Warning in t(a) %*% betahat + pm * qt(1 - alpha/2, df) * s * sqrt(t(a) %*% : Recycling array of length 1 in array-vector arithmetic is deprecated.
##   Use c() or as.vector() instead.
```

```
## $CIs
##               [,1]        [,2]
## beta0 -42351.99214  40291.9269
## beta1    -96.96528    -18.8335
## beta2 289830.70396 374243.4682
## 
## $betahat
##              [,1]
## [1,]  -1030.03261
## [2,]    -57.89939
## [3,] 332037.08606
## 
## $SSE
##             [,1]
## [1,] 11931113453
## 
## $s2
##           [,1]
## [1,] 745694591
```

```r
rglwidget()
```

<!--html_preserve--><div id="rgl62253" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl62253">{"x":{"material":{"color":"#00FF00","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"67":{"id":67,"type":"points","material":{"lit":false,"fog":false},"vertices":[[0,0,0.0233545657247305],[0,0.164705887436867,0.0700636953115463],[0,0.258823543787003,0.34394896030426],[0,0.552941203117371,0.469214528799057],[0,0.835294127464294,0.728237867355347],[0,1,1],[0.499383479356766,0,0.0063694161362946],[0.499383479356766,0.164705887436867,0.050955418497324],[0.499383479356766,0.258823543787003,0.295116662979126],[0.499383479356766,0.552941203117371,0.409766435623169],[0.499383479356766,0.835294127464294,0.639065742492676],[0.499383479356766,1,0.92144364118576],[1,0,0],[1,0.164705887436867,0.0403397157788277],[1,0.258823543787003,0.250530779361725],[1,0.552941203117371,0.312101870775223],[1,0.835294127464294,0.54777055978775],[1,1,0.662420332431793]],"colors":[[0,0,1,1]],"centers":[[0,0,0.0233545657247305],[0,0.164705887436867,0.0700636953115463],[0,0.258823543787003,0.34394896030426],[0,0.552941203117371,0.469214528799057],[0,0.835294127464294,0.728237867355347],[0,1,1],[0.499383479356766,0,0.0063694161362946],[0.499383479356766,0.164705887436867,0.050955418497324],[0.499383479356766,0.258823543787003,0.295116662979126],[0.499383479356766,0.552941203117371,0.409766435623169],[0.499383479356766,0.835294127464294,0.639065742492676],[0.499383479356766,1,0.92144364118576],[1,0,0],[1,0.164705887436867,0.0403397157788277],[1,0.258823543787003,0.250530779361725],[1,0.552941203117371,0.312101870775223],[1,0.835294127464294,0.54777055978775],[1,1,0.662420332431793]],"ignoreExtent":false,"flags":4096},"69":{"id":69,"type":"text","material":{"lit":false,"fog":false},"vertices":[[0.5,-0.16949999332428,-0.16949999332428]],"colors":[[0,0,0,1]],"texts":[["x1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0.5,-0.16949999332428,-0.16949999332428]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"70":{"id":70,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-0.16949999332428,0.5,-0.16949999332428]],"colors":[[0,0,0,1]],"texts":[["y1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,0.5,-0.16949999332428]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"71":{"id":71,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-0.16949999332428,-0.16949999332428,0.5]],"colors":[[0,0,0,1]],"texts":[["z1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,-0.16949999332428,0.5]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"72":{"id":72,"type":"lines","material":{"lit":false},"vertices":[[-1.10000002384186,0,0],[1.10000002384186,0,0]],"colors":[[0,0,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"73":{"id":73,"type":"lines","material":{"lit":false},"vertices":[[0,-1.10000002384186,0],[0,1.10000002384186,0]],"colors":[[1,0,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"74":{"id":74,"type":"lines","material":{"lit":false},"vertices":[[0,0,-1.10000002384186],[0,0,1.10000002384186]],"colors":[[0,1,0,1]],"centers":[[0,0,0]],"ignoreExtent":false,"flags":64},"75":{"id":75,"type":"planes","material":{"alpha":0.498039215803146,"isTransparent":true},"vertices":[[-1.10000002384186,-1.10000002384186,-0.696003556251526],[1.10000002384186,1.10000002384186,0.813678443431854],[1.10000002384186,-1.10000002384186,-0.997307121753693]],"normals":[[-0.136956170201302,0.823175251483917,-1]],"colors":[[0.627451002597809,0.125490203499794,0.941176474094391,0.498039215803146]],"offsets":[[0.0588374398648739]],"centers":[[0.366666674613953,-0.366666674613953,-0.293210744857788],[-0.330202460289001,0.366666674613953,0.40589165687561],[-1.06353580951691,0.360599935054779,0.50133216381073],["NaN","NaN","NaN"]],"ignoreExtent":true,"flags":35},"5":{"id":5,"reuse":"rgl84746"},"6":{"id":6,"reuse":"rgl84746"},"68":{"id":68,"type":"bboxdeco","material":{"color":"#000000","front":"lines","back":"lines","fog":false},"vertices":[[-1,"NA","NA"],[-0.5,"NA","NA"],[0,"NA","NA"],[0.5,"NA","NA"],[1,"NA","NA"],["NA",-1,"NA"],["NA",-0.5,"NA"],["NA",0,"NA"],["NA",0.5,"NA"],["NA",1,"NA"],["NA","NA",-1],["NA","NA",-0.5],["NA","NA",0],["NA","NA",0.5],["NA","NA",1]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[83,84,85,86,87,88,89]},"1":{"id":1,"type":"subscene","par3d":{"antialias":0,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,9.32436943054199],"modelMatrix":[[1,0,0,0],[0,0.342020153999329,0.939692616462708,0],[0,-0.939692616462708,0.342020153999329,-9.32436943054199],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370325088501,-33.6132736206055],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-1.10000002384186,1.10000002384186,-1.10000002384186,1.10000002384186,-1.10000002384186,1.10000002384186],"windowRect":[48,147,304,403],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/home/collindabbieri/R/x86_64-redhat-linux-gnu-library/3.5/rgl/fonts/FreeSans.ttf","maxClipPlanes":8,"glVersion":3,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,68,67,69,70,71,72,73,74,75,5,83,84,85,86,87,88,89],"subscenes":[],"flags":6771},"83":{"id":83,"type":"lines","material":{"lit":false},"vertices":[[-1,-1.13300001621246,-1.13300001621246],[1,-1.13300001621246,-1.13300001621246],[-1,-1.13300001621246,-1.13300001621246],[-1,-1.18965005874634,-1.18965005874634],[-0.5,-1.13300001621246,-1.13300001621246],[-0.5,-1.18965005874634,-1.18965005874634],[0,-1.13300001621246,-1.13300001621246],[0,-1.18965005874634,-1.18965005874634],[0.5,-1.13300001621246,-1.13300001621246],[0.5,-1.18965005874634,-1.18965005874634],[1,-1.13300001621246,-1.13300001621246],[1,-1.18965005874634,-1.18965005874634]],"colors":[[0,0,0,1]],"centers":[[0,-1.13300001621246,-1.13300001621246],[-1,-1.16132497787476,-1.16132497787476],[-0.5,-1.16132497787476,-1.16132497787476],[0,-1.16132497787476,-1.16132497787476],[0.5,-1.16132497787476,-1.16132497787476],[1,-1.16132497787476,-1.16132497787476]],"ignoreExtent":true,"origId":68,"flags":64},"84":{"id":84,"type":"text","material":{"lit":false},"vertices":[[-1,-1.3029500246048,-1.3029500246048],[-0.5,-1.3029500246048,-1.3029500246048],[0,-1.3029500246048,-1.3029500246048],[0.5,-1.3029500246048,-1.3029500246048],[1,-1.3029500246048,-1.3029500246048]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1,-1.3029500246048,-1.3029500246048],[-0.5,-1.3029500246048,-1.3029500246048],[0,-1.3029500246048,-1.3029500246048],[0.5,-1.3029500246048,-1.3029500246048],[1,-1.3029500246048,-1.3029500246048]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":68,"flags":2064},"85":{"id":85,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1,-1.13300001621246],[-1.13300001621246,1,-1.13300001621246],[-1.13300001621246,-1,-1.13300001621246],[-1.18965005874634,-1,-1.18965005874634],[-1.13300001621246,-0.5,-1.13300001621246],[-1.18965005874634,-0.5,-1.18965005874634],[-1.13300001621246,0,-1.13300001621246],[-1.18965005874634,0,-1.18965005874634],[-1.13300001621246,0.5,-1.13300001621246],[-1.18965005874634,0.5,-1.18965005874634],[-1.13300001621246,1,-1.13300001621246],[-1.18965005874634,1,-1.18965005874634]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,0,-1.13300001621246],[-1.16132497787476,-1,-1.16132497787476],[-1.16132497787476,-0.5,-1.16132497787476],[-1.16132497787476,0,-1.16132497787476],[-1.16132497787476,0.5,-1.16132497787476],[-1.16132497787476,1,-1.16132497787476]],"ignoreExtent":true,"origId":68,"flags":64},"86":{"id":86,"type":"text","material":{"lit":false},"vertices":[[-1.3029500246048,-1,-1.3029500246048],[-1.3029500246048,-0.5,-1.3029500246048],[-1.3029500246048,0,-1.3029500246048],[-1.3029500246048,0.5,-1.3029500246048],[-1.3029500246048,1,-1.3029500246048]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.3029500246048,-1,-1.3029500246048],[-1.3029500246048,-0.5,-1.3029500246048],[-1.3029500246048,0,-1.3029500246048],[-1.3029500246048,0.5,-1.3029500246048],[-1.3029500246048,1,-1.3029500246048]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":68,"flags":2064},"87":{"id":87,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1.13300001621246,-1],[-1.13300001621246,-1.13300001621246,1],[-1.13300001621246,-1.13300001621246,-1],[-1.18965005874634,-1.18965005874634,-1],[-1.13300001621246,-1.13300001621246,-0.5],[-1.18965005874634,-1.18965005874634,-0.5],[-1.13300001621246,-1.13300001621246,0],[-1.18965005874634,-1.18965005874634,0],[-1.13300001621246,-1.13300001621246,0.5],[-1.18965005874634,-1.18965005874634,0.5],[-1.13300001621246,-1.13300001621246,1],[-1.18965005874634,-1.18965005874634,1]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,-1.13300001621246,0],[-1.16132497787476,-1.16132497787476,-1],[-1.16132497787476,-1.16132497787476,-0.5],[-1.16132497787476,-1.16132497787476,0],[-1.16132497787476,-1.16132497787476,0.5],[-1.16132497787476,-1.16132497787476,1]],"ignoreExtent":true,"origId":68,"flags":64},"88":{"id":88,"type":"text","material":{"lit":false},"vertices":[[-1.3029500246048,-1.3029500246048,-1],[-1.3029500246048,-1.3029500246048,-0.5],[-1.3029500246048,-1.3029500246048,0],[-1.3029500246048,-1.3029500246048,0.5],[-1.3029500246048,-1.3029500246048,1]],"colors":[[0,0,0,1]],"texts":[["-1"],["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.3029500246048,-1.3029500246048,-1],[-1.3029500246048,-1.3029500246048,-0.5],[-1.3029500246048,-1.3029500246048,0],[-1.3029500246048,-1.3029500246048,0.5],[-1.3029500246048,-1.3029500246048,1]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":68,"flags":2064},"89":{"id":89,"type":"lines","material":{"lit":false},"vertices":[[-1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[-1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[-1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[-1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[-1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[-1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246],[1.13300001621246,-1.13300001621246,-1.13300001621246],[1.13300001621246,-1.13300001621246,1.13300001621246],[1.13300001621246,1.13300001621246,-1.13300001621246],[1.13300001621246,1.13300001621246,1.13300001621246]],"colors":[[0,0,0,1]],"centers":[[-1.13300001621246,0,-1.13300001621246],[-1.13300001621246,0,1.13300001621246],[-1.13300001621246,-1.13300001621246,0],[-1.13300001621246,1.13300001621246,0],[0,-1.13300001621246,-1.13300001621246],[0,-1.13300001621246,1.13300001621246],[0,1.13300001621246,-1.13300001621246],[0,1.13300001621246,1.13300001621246],[1.13300001621246,0,-1.13300001621246],[1.13300001621246,0,1.13300001621246],[1.13300001621246,-1.13300001621246,0],[1.13300001621246,1.13300001621246,0]],"ignoreExtent":true,"origId":68,"flags":64},"96":{"id":96,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":96,"sphereVerts":{"reuse":"rgl84746"},"context":{"shiny":false,"rmarkdown":"html_document"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

